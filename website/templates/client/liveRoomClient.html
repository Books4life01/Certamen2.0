{%extends "home/base.html"%}
{%block title%}LiveRoomCLient{%endblock%}

{%block script%}
<script src="{{url_for('static', filename='script/roomClientBaseCode.js')}}"></script>

<script>
    let roomKey = {{ roomKey|tojson }};
    let player = {{ player|tojson}};
   
    socket.on("roomTeamsUpdate", (data) =>{
        //Ensure that the room we are recieving data for is the room we are in
        if (data.roomKey == {{ roomKey|tojson }}){
            let teams = data.teams;
            console.log(teams);
        }
        
    });
    socket.on("roomParticipantUpdate", (data)=>{
        if(data["roomKey"]==roomKey){
            let players = JSON.parse(data['participants']);
            console.log(players);
            ['A','B','C','D'].forEach((letter) =>{
                players.forEach((player)=>{
                    console.log(roomData["team" + letter] + " " + player['teamKey']);
                    if(roomData["team" + letter] == player['teamKey']){
                        console.log('#' + letter + 'Label');
                        $('<i class="fa-solid fa-user"></i>').attr("title", player["name"]).insertBefore('#' + letter + 'Label');
                    }
                })
            });
          
        }
        
    })
    
    
    
    function documentReady(){
       
        $(document).on("keypress", function(e){
            if(e.which == 32){
                console.log("SPACE PRESSED");
                socket.emit("liveQuestionUpdate", data = {"roomKey": roomKey, "player":player,"questionNum": curQuestion,"questionType": roomData.curQuestionType, "actionType":"pause","questionNum":curQuestion,  "answer":$("#answerInput").val()})
            }
            console.log("KEY PRESSED: " + e.which);
        });
        $("#submitAnswerButton").click(()=>{
            submitAnswer();
        })

       
        
    }
</script>
{%endblock%}

{%block styles%}<style>
    #currentQuestionHolder{
        font-size: 2em;
        font-weight: bold;
        text-align: center;
        border: 1px dotted  white;
        width:50%;
        height:60%;
        margin: 0 0;
    }
    #pastQuestions{
        border: 1px dotted orange;
        border-radius: 25px;
        width:35%;
        height:80%;
        margin-left: 1%;
        
    }
    #liveQuestionReciever{
        border: 1px dotted blue;
        height: 50%;
        overflow: auto;
    }
    
    .container{
        position: relative;
        display: flex;
        flex-direction: row;
        justify-content: space-evenly;
        align-items: center;
        border: 1px dotted red;
        width:100%;
        max-width:none;
        height:500px;

    }
    #submitAnswer{
        display: flex;
        flex-direction: row;
    }
    .hidden{
        display:none !important;
    }  
    #questionAnswer{
        height:20%;
    } 
    
    #answerContainer{
        border: 1px dotted yellow;
        display: flex;
        flex-direction: row;
        flex-wrap: nowrap;
        
    } 
    .verticalTeamHolder{
        display: flex;
        flex-direction: column;
        justify-content: space-evenly;
        align-items: center;
        width:5%;
        height:60%;
        margin:20% 1%;
        border: 1px solid purple;
        flex-wrap: wrap;
    }
    #topTeam{
        position: absolute;
        display: flex;
        flex-direction: row;
        justify-content: space-evenly;
        align-items: center;
        width:50%;
        height:10%;
        top:9%;
        left:43%;
        border: 1px solid purple;
        flex-wrap: wrap;
    }
    #bottomTeam{
        position: absolute;
        display: flex;
        flex-direction: row;
        justify-content: space-evenly;
        align-items: center;
        width:50%;
        height:10%;
        bottom:9%;
        left:43%;
        border: 1px solid purple;
        flex-wrap: wrap;
    }
    .horizantalTeamLabel{
        flex-basis:100%;
        text-align: center;
    }
    .verticalTeamLabel{
        flex-basis:100%;
        text-align: center;
        text-orientation: upright;
        writing-mode: vertical-rl;
    }
    
</style>{%endblock%}

{%block content%}
<div class="container">
    <div id="pastQuestions">

    </div>
    
    <div id="topTeam">
        <div class="horizantalTeamLabel" id="ALabel"> Team A</div>
    </div>
    <div id="bottomTeam">
        <div class="horizantalTeamLabel" id="CLabel"> Team C</div>
    </div>
    <div class="verticalTeamHolder" id="leftTeam">
        <div class="verticalTeamLabel" id="DLabel"> Team D</div>
    </div>

    <div id="currentQuestionHolder">
        <h1 class="center" id="questionTitle">Question #1</h1>
        <div id="liveQuestionReciever"></div>
        <div id="questionAnswer">
            <h6 id="liveQuestionClientInfo">Press Space to Buzz in</h6>
            <div class="hidden form-group"id="submitAnswer">
                <textArea class="form-control" id="answerInput"></textArea>
                <button class="input-group-text btn btn-primary"id="submitAnswerButton">Submit Answer</button>
            </div>
            <div id="liveAnswerReciever" class="hidden">
            </div>
        </div>
        
    </div>
    <div class="verticalTeamHolder" id="rightTeam">
        <div class="verticalTeamLabel" id="BLabel"> Team B</div>

    </div>

    
</div>
{%endblock%}